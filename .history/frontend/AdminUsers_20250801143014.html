<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Admin Dashboard - Users</title>
        <script src="https://cdn.tailwindcss.com/3.4.16"></script>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" />
        <style>
            body {
                font-family: "Inter", sans-serif;
                background-color: #f8f9fb;
            }

            /* ...existing styles for custom-select, modal, etc... */
        </style>
    </head>

    <body class="min-h-screen">
        <!-- Header and Sidebar (optional for standalone) -->
        <main class="pt-16 md:pl-64 transition-all duration-300">
            <!-- Users Tab -->
            <div id="users-tab" class="tab-content p-4 md:p-6">
                <div class="mb-6">
                    <h1 class="text-2xl font-semibold text-gray-800">Users Management</h1>
                    <p class="text-sm text-gray-500 mt-1">
                        Manage all registered users and their accounts
                    </p>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                        <div class="relative flex-1">
                            <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                <i class="ri-search-line text-gray-400"></i>
                            </div>
                            <input type="text" id="user-search"
                                class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
                                placeholder="Search users by name or email..." />
                        </div>
                        <div class="flex flex-wrap items-center gap-3">
                            <div class="custom-select" id="plan-filter">
                                <div class="custom-select-trigger">
                                    <span>All Plans</span>
                                    <i class="ri-arrow-down-s-line ml-2"></i>
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" data-value="all">
                                        All Plans
                                    </div>
                                    <div class="custom-select-option" data-value="basic">
                                        Basic
                                    </div>
                                    <div class="custom-select-option" data-value="pro">Pro</div>
                                    <div class="custom-select-option" data-value="enterprise">
                                        Enterprise
                                    </div>
                                </div>
                            </div>
                            <div class="custom-select" id="status-filter">
                                <div class="custom-select-trigger">
                                    <span>All Status</span>
                                    <i class="ri-arrow-down-s-line ml-2"></i>
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" data-value="all">
                                        All Status
                                    </div>
                                    <div class="custom-select-option" data-value="active">
                                        Active
                                    </div>
                                    <div class="custom-select-option" data-value="suspended">
                                        Suspended
                                    </div>
                                </div>
                            </div>
                            <button
                                class="px-4 py-2 bg-primary text-white rounded-button whitespace-nowrap flex items-center"
                                id="export-users-btn">
                                <i class="ri-download-2-line mr-2"></i>
                                Export
                            </button>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full" id="users-table">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-4 py-3 text-left">
                                        <label class="custom-checkbox">
                                            <input type="checkbox" id="select-all-users" />
                                            <span class="checkbox-mark"></span>
                                        </label>
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        User
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Email
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Plan
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Wallet
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Joined
                                    </th>
                                    <th
                                        class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Status
                                    </th>
                                    <th
                                        class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Actions
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="users-table-body">
                                <!-- Filled by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div class="px-4 py-3 flex items-center justify-between border-t">
                        <div class="flex items-center text-sm text-gray-500" id="users-pagination-info">
                            <span>Showing</span>
                            <div class="custom-select mx-2" id="page-size-select">
                                <div class="custom-select-trigger">
                                    <span>10</span>
                                    <i class="ri-arrow-down-s-line ml-1"></i>
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" data-value="10">10</div>
                                    <div class="custom-select-option" data-value="20">20</div>
                                    <div class="custom-select-option" data-value="50">50</div>
                                </div>
                            </div>
                            <span id="users-total-count">of 50 users</span>
                        </div>
                        <div class="flex items-center space-x-1" id="users-pagination">
                            <button class="pagination-item text-gray-500 hover:bg-gray-100" id="users-prev-page">
                                <i class="ri-arrow-left-s-line"></i>
                            </button>
                            <!-- Page numbers will be injected here -->
                            <button class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                                data-page="1">
                                1
                            </button>
                            <button class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                                data-page="2">
                                2
                            </button>
                            <button class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                                data-page="3">
                                3
                            </button>
                            <button class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                                data-page="4">
                                4
                            </button>
                            <button class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                                data-page="5">
                                5
                            </button>
                            <button class="pagination-item text-gray-500 hover:bg-gray-100" id="users-next-page">
                                <i class="ri-arrow-right-s-line"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            
        </main>

        <!-- Modals -->
         <!-- Unsuspend User Modal -->
            <div id="unsuspend-user-modal" class="modal">
                <div class="modal-content">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium text-gray-800">Unsuspend User</h3>
                        <button class="modal-close text-gray-400 hover:text-gray-500">
                            <i class="ri-close-line ri-lg"></i>
                        </button>
                    </div>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <div
                                class="w-12 h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center">
                                <i class="ri-play-circle-line ri-lg"></i>
                            </div>
                            <div class="ml-4">
                                <h4 class="text-lg font-medium text-gray-800">
                                    Are you sure you want to unsuspend this user?
                                </h4>
                                <p class="text-sm text-gray-500">
                                    The user will regain access to their account immediately.
                                </p>
                            </div>
                        </div>
                        <div>
                            <label for="unsuspend-reason" class="block text-sm font-medium text-gray-700 mb-1">Reason
                                for unsuspension
                                (optional)</label>
                            <textarea id="unsuspend-reason" rows="3"
                                class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
                                placeholder="Enter reason for unsuspension..."></textarea>
                        </div>
                        <div class="flex items-center">
                            <label class="custom-checkbox">
                                <input type="checkbox" checked />
                                <span class="checkbox-mark"></span>
                            </label>
                            <span class="ml-2 text-sm text-gray-600">Send email notification to user</span>
                        </div>
                        <div class="flex items-center justify-end space-x-3 pt-4 border-t">
                            <button
                                class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50 modal-close">
                                Cancel
                            </button>
                            <button class="px-4 py-2 bg-green-600 text-white rounded-button whitespace-nowrap"
                                id="confirm-unsuspend-user">
                                Unsuspend User
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        <script>
                (function () {
                    // Mock user data
                    const mockUsers = [];
                    const plans = [
                        { name: "Basic", color: "bg-gray-100 text-gray-600" },
                        { name: "Pro", color: "bg-blue-50 text-primary" },
                        { name: "Enterprise", color: "bg-purple-50 text-purple-600" },
                    ];
                    const statuses = [
                        { name: "Active", color: "bg-green-50 text-green-600" },
                        { name: "Suspended", color: "bg-yellow-50 text-yellow-600" },
                    ];
                    const walletStates = [
                        { name: "Connected", color: "text-green-600 bg-green-50" },
                        { name: "Not Connected", color: "text-gray-600 bg-gray-100" },
                    ];
                    const names = [
                        "Emma Brown",
                        "Robert Johnson",
                        "Sarah Wilson",
                        "David Miller",
                        "Jessica Thompson",
                        "Michael Lee",
                        "Sophia Davis",
                        "James Smith",
                        "Olivia Garcia",
                        "William Martinez",
                        "Ava Rodriguez",
                        "Benjamin Anderson",
                        "Mia Hernandez",
                        "Lucas Clark",
                        "Charlotte Lewis",
                        "Henry Walker",
                        "Amelia Hall",
                        "Jack Allen",
                        "Emily Young",
                        "Alexander King",
                        "Ella Wright",
                        "Daniel Scott",
                        "Grace Green",
                        "Matthew Adams",
                        "Chloe Baker",
                        "Sebastian Nelson",
                        "Harper Carter",
                        "Jackson Mitchell",
                        "Lily Perez",
                        "Logan Roberts",
                        "Zoe Turner",
                        "Mason Phillips",
                        "Layla Campbell",
                        "Elijah Parker",
                        "Scarlett Evans",
                        "Aiden Edwards",
                        "Penelope Collins",
                        "Carter Stewart",
                        "Riley Sanchez",
                        "Wyatt Morris",
                        "Victoria Rogers",
                        "Julian Reed",
                        "Hannah Cook",
                        "Levi Morgan",
                        "Aria Bell",
                        "Gabriel Murphy",
                        "Nora Bailey",
                        "Lincoln Rivera",
                        "Sofia Cooper",
                        "Samuel Richardson",
                    ];
                    for (let i = 0; i < 50; i++) {
                        const planIdx = Math.floor(Math.random() * plans.length);
                        const statusIdx = Math.random() < 0.8 ? 0 : 1; // 80% active, 20% suspended
                        const walletIdx = Math.random() < 0.8 ? 0 : 1; // 80% connected
                        const joined = new Date(
                            2025,
                            Math.floor(Math.random() * 6),
                            1 + Math.floor(Math.random() * 28)
                        );
                        const initials = names[i]
                            .split(" ")
                            .map((n) => n[0])
                            .join("");
                        mockUsers.push({
                            id: i + 1,
                            name: names[i],
                            email: names[i].toLowerCase().replace(/ /g, ".") + "@example.com",
                            plan: plans[planIdx].name,
                            planColor: plans[planIdx].color,
                            wallet: walletStates[walletIdx].name,
                            walletColor: walletStates[walletIdx].color,
                            joined: joined.toLocaleDateString("en-US", {
                                month: "short",
                                day: "2-digit",
                                year: "numeric",
                            }),
                            status: statuses[statusIdx].name,
                            statusColor: statuses[statusIdx].color,
                            initials: initials,
                        });
                    }

                    // State
                    let filteredUsers = [...mockUsers];
                    let currentPage = 1;
                    let pageSize = 10;
                    let planFilter = "all";
                    let statusFilter = "all";
                    let searchQuery = "";

                    // DOM
                    const tbody = document.getElementById("users-table-body");
                    const pageSizeSelect = document.getElementById("page-size-select");
                    const planFilterSelect = document.getElementById("plan-filter");
                    const statusFilterSelect = document.getElementById("status-filter");
                    const searchInput = document.getElementById("user-search");
                    const pagination = document.getElementById("users-pagination");
                    const prevBtn = document.getElementById("users-prev-page");
                    const nextBtn = document.getElementById("users-next-page");
                    const pageInfo = document.getElementById("users-pagination-info");
                    const totalCount = document.getElementById("users-total-count");

                    // For unsuspend modal
                    let unsuspendUserId = null;

                    // Render
                    function renderTable() {
                        // Filter
                        filteredUsers = mockUsers.filter((u) => {
                            let matchesPlan =
                                planFilter === "all" || u.plan.toLowerCase() === planFilter;
                            let matchesStatus =
                                statusFilter === "all" ||
                                u.status.toLowerCase() === statusFilter;
                            let matchesSearch =
                                !searchQuery ||
                                u.name.toLowerCase().includes(searchQuery) ||
                                u.email.toLowerCase().includes(searchQuery);
                            return matchesPlan && matchesStatus && matchesSearch;
                        });
                        // Pagination
                        const total = filteredUsers.length;
                        const totalPages = Math.max(1, Math.ceil(total / pageSize));
                        if (currentPage > totalPages) currentPage = totalPages;
                        const start = (currentPage - 1) * pageSize;
                        const end = Math.min(start + pageSize, total);
                        const usersToShow = filteredUsers.slice(start, end);

                        // Table rows
                        tbody.innerHTML = usersToShow
                            .map(
                                (user) => `
            <tr>
                <td class="px-4 py-3 whitespace-nowrap">
                    <label class="custom-checkbox">
                        <input type="checkbox" class="user-checkbox">
                        <span class="checkbox-mark"></span>
                    </label>
                </td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full ${user.plan === "Pro"
                                        ? "bg-blue-100 text-primary"
                                        : user.plan === "Enterprise"
                                            ? "bg-purple-100 text-purple-600"
                                            : user.plan === "Basic"
                                                ? "bg-orange-100 text-orange-600"
                                                : "bg-gray-100 text-gray-600"
                                    } flex items-center justify-center">
                            <span class="text-sm font-medium">${user.initials
                                    }</span>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm font-medium text-gray-800">${user.name
                                    }</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-600">${user.email
                                    }</td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium ${user.planColor
                                    } rounded-full">${user.plan}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="text-xs font-medium ${user.walletColor
                                    } px-2 py-1 rounded-full">${user.wallet}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-600">${user.joined
                                    }</td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium ${user.statusColor
                                    } rounded-full">${user.status}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-right text-sm font-medium">
                    <div class="flex items-center justify-end space-x-2">
                        <button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-primary rounded-full hover:bg-blue-50" data-action="view" data-user-id="${user.id
                                    }">
                            <i class="ri-eye-line"></i>
                        </button>
                        ${user.status === "Suspended"
                                        ? `<button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-green-500 rounded-full hover:bg-green-50" data-action="activate" data-user-id="${user.id}">
                                        <i class="ri-play-circle-line"></i>
                                    </button>`
                                        : `<button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-yellow-500 rounded-full hover:bg-yellow-50" data-action="suspend" data-user-id="${user.id}">
                                        <i class="ri-pause-circle-line"></i>
                                    </button>`
                                    }
                        <button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-red-500 rounded-full hover:bg-red-50" data-action="delete" data-user-id="${user.id
                                    }">
                            <i class="ri-delete-bin-line"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `
                            )
                            .join("");

                        // Pagination info
                        pageInfo.querySelector(
                            "span"
                        ).nextElementSibling.nextElementSibling.textContent = `of ${total} users`;
                        pageInfo.querySelector(
                            "span"
                        ).nextElementSibling.textContent = `${pageSize}`;

                        // Pagination buttons
                        renderPagination(totalPages);

                        // Select all checkbox
                        const selectAll = document.getElementById("select-all-users");
                        const checkboxes = tbody.querySelectorAll(".user-checkbox");
                        if (selectAll) {
                            selectAll.checked = false;
                            selectAll.onchange = function () {
                                checkboxes.forEach((cb) => (cb.checked = selectAll.checked));
                            };
                        }

                        // Re-attach modal event listeners for user action buttons
                        setTimeout(() => {
                            const viewUserButtons = tbody.querySelectorAll(
                                '[data-action="view"]'
                            );
                            const deleteUserButtons = tbody.querySelectorAll(
                                '[data-action="delete"]'
                            );
                            const suspendUserButtons = tbody.querySelectorAll(
                                '[data-action="suspend"]'
                            );
                            const activateUserButtons = tbody.querySelectorAll(
                                '[data-action="activate"]'
                            );
                            viewUserButtons.forEach((button) => {
                                button.onclick = function () {
                                    const userId = this.getAttribute("data-user-id");
                                    const modal = document.getElementById("view-user-modal");
                                    if (modal) {
                                        modal.classList.add("active");
                                        document.body.style.overflow = "hidden";
                                    }
                                };
                            });
                            deleteUserButtons.forEach((button) => {
                                button.onclick = function () {
                                    const userId = this.getAttribute("data-user-id");
                                    const modal = document.getElementById("delete-user-modal");
                                    if (modal) {
                                        modal.classList.add("active");
                                        document.body.style.overflow = "hidden";
                                    }
                                };
                            });
                            suspendUserButtons.forEach((button) => {
                                button.onclick = function () {
                                    const userId = this.getAttribute("data-user-id");
                                    const modal = document.getElementById("suspend-user-modal");
                                    if (modal) {
                                        modal.classList.add("active");
                                        document.body.style.overflow = "hidden";
                                    }
                                };
                            });
                            // Unsuspend (activate) user modal
                            activateUserButtons.forEach((button) => {
                                button.onclick = function () {
                                    unsuspendUserId = this.getAttribute("data-user-id");
                                    const modal = document.getElementById("unsuspend-user-modal");
                                    if (modal) {
                                        modal.classList.add("active");
                                        document.body.style.overflow = "hidden";
                                    }
                                };
                            });
                        }, 0);
                    }

                    function renderPagination(totalPages) {
                        // Remove old page buttons
                        pagination
                            .querySelectorAll(".users-page-btn")
                            .forEach((btn) => btn.remove());
                        // Insert new page buttons
                        for (let i = 1; i <= totalPages; i++) {
                            const btn = document.createElement("button");
                            btn.className =
                                "pagination-item text-gray-600 hover:bg-gray-100 users-page-btn";
                            btn.textContent = i;
                            btn.setAttribute("data-page", i);
                            if (i === currentPage)
                                btn.classList.add("active", "bg-blue-50", "text-primary");
                            btn.onclick = function () {
                                currentPage = i;
                                renderTable();
                            };
                            pagination.insertBefore(btn, nextBtn);
                        }
                        // Prev/next
                        prevBtn.disabled = currentPage === 1;
                        nextBtn.disabled = currentPage === totalPages;
                        prevBtn.classList.toggle("opacity-50", prevBtn.disabled);
                        prevBtn.classList.toggle("cursor-not-allowed", prevBtn.disabled);
                        nextBtn.classList.toggle("opacity-50", nextBtn.disabled);
                        nextBtn.classList.toggle("cursor-not-allowed", nextBtn.disabled);
                    }

                    // Event listeners
                    prevBtn.onclick = function () {
                        if (currentPage > 1) {
                            currentPage--;
                            renderTable();
                        }
                    };
                    nextBtn.onclick = function () {
                        const total = filteredUsers.length;
                        const totalPages = Math.max(1, Math.ceil(total / pageSize));
                        if (currentPage < totalPages) {
                            currentPage++;
                            renderTable();
                        }
                    };

                    // Page size select
                    pageSizeSelect.addEventListener("change", function (e) {
                        const value = pageSizeSelect.getAttribute("data-value");
                        if (value) {
                            pageSize = parseInt(value, 10);
                            currentPage = 1;
                            renderTable();
                        }
                    });
                    // Plan filter
                    planFilterSelect.addEventListener("change", function (e) {
                        planFilter = planFilterSelect.getAttribute("data-value") || "all";
                        currentPage = 1;
                        renderTable();
                    });
                    // Status filter
                    statusFilterSelect.addEventListener("change", function (e) {
                        statusFilter =
                            statusFilterSelect.getAttribute("data-value") || "all";
                        currentPage = 1;
                        renderTable();
                    });
                    // Search
                    searchInput.addEventListener("input", function () {
                        searchQuery = searchInput.value.trim().toLowerCase();
                        currentPage = 1;
                        renderTable();
                    });

                    // Export (CSV)
                    document.getElementById("export-users-btn").onclick = function () {
                        let csv = "Name,Email,Plan,Wallet,Joined,Status\n";
                        filteredUsers.forEach((u) => {
                            csv += `"${u.name}","${u.email}","${u.plan}","${u.wallet}","${u.joined}","${u.status}"\n`;
                        });
                        const blob = new Blob([csv], { type: "text/csv" });
                        const a = document.createElement("a");
                        a.href = URL.createObjectURL(blob);
                        a.download = "users.csv";
                        a.click();
                    };

                    // Unsuspend user modal logic
                    document.addEventListener("DOMContentLoaded", function () {
                        const unsuspendModal = document.getElementById(
                            "unsuspend-user-modal"
                        );
                        const confirmBtn = document.getElementById(
                            "confirm-unsuspend-user"
                        );
                        if (confirmBtn) {
                            confirmBtn.onclick = function () {
                                if (unsuspendUserId) {
                                    // Find user and set status to Active
                                    const user = mockUsers.find((u) => u.id == unsuspendUserId);
                                    if (user) {
                                        user.status = "Active";
                                        user.statusColor = "bg-green-50 text-green-600";
                                    }
                                    unsuspendUserId = null;
                                    renderTable();
                                }
                                if (unsuspendModal) {
                                    unsuspendModal.classList.remove("active");
                                    document.body.style.overflow = "";
                                }
                            };
                        }
                    });

                    // Initial render
                    renderTable();

                    // Custom select event patch for vanilla selects
                    // (so the above .addEventListener("change") works)
                    document.querySelectorAll(".custom-select").forEach((select) => {
                        select.addEventListener("change", function (e) {
                            // Already handled above
                        });
                    });
                })();
            </script>
    </body>

</html>