<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Users</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { primary: "#1E3A8A", secondary: "#5BC0EB" },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <style>
      :where([class^="ri-"])::before {
        content: "\f3c2";
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: #f8f9fb;
      }

      .sidebar-transition {
        transition: width 0.3s ease, transform 0.3s ease;
      }

      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      .custom-switch {
        position: relative;
        display: inline-block;
        width: 44px;
        height: 24px;
      }

      .custom-switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .switch-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #e2e8f0;
        transition: 0.4s;
        border-radius: 24px;
      }

      .switch-slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
      }

      input:checked + .switch-slider {
        background-color: #3366ff;
      }

      input:checked + .switch-slider:before {
        transform: translateX(20px);
      }

      .custom-checkbox {
        position: relative;
        display: inline-block;
        width: 18px;
        height: 18px;
      }

      .custom-checkbox input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .checkbox-mark {
        position: absolute;
        top: 0;
        left: 0;
        height: 18px;
        width: 18px;
        background-color: #fff;
        border: 1px solid #d1d5db;
        border-radius: 4px;
      }

      .custom-checkbox input:checked ~ .checkbox-mark {
        background-color: #3366ff;
        border-color: #3366ff;
      }

      .checkbox-mark:after {
        content: "";
        position: absolute;
        display: none;
      }

      .custom-checkbox input:checked ~ .checkbox-mark:after {
        display: block;
      }

      .custom-checkbox .checkbox-mark:after {
        left: 6px;
        top: 2px;
        width: 5px;
        height: 10px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
      }

      .custom-radio {
        position: relative;
        display: inline-block;
        width: 18px;
        height: 18px;
      }

      .custom-radio input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .radio-mark {
        position: absolute;
        top: 0;
        left: 0;
        height: 18px;
        width: 18px;
        background-color: #fff;
        border: 1px solid #d1d5db;
        border-radius: 50%;
      }

      .custom-radio input:checked ~ .radio-mark {
        background-color: #fff;
        border-color: #3366ff;
      }

      .radio-mark:after {
        content: "";
        position: absolute;
        display: none;
      }

      .custom-radio input:checked ~ .radio-mark:after {
        display: block;
      }

      .custom-radio .radio-mark:after {
        top: 4px;
        left: 4px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #3366ff;
      }

      .pagination-item {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        cursor: pointer;
      }

      .pagination-item.active {
        background-color: #3366ff;
        color: white;
      }

      .custom-select {
        position: relative;
        display: inline-block;
      }

      .custom-select-trigger {
        padding: 8px 12px;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        background-color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-width: 120px;
      }

      .custom-select-options {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: white;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-top: 4px;
        z-index: 10;
        display: none;
        max-height: 200px;
        overflow-y: auto;
      }

      .custom-select-option {
        padding: 8px 12px;
        cursor: pointer;
      }

      .custom-select-option:hover {
        background-color: #f1f5f9;
      }

      .custom-select.open .custom-select-options {
        display: block;
      }

      .modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 50;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
      }

      .modal.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background-color: white;
        border-radius: 12px;
        padding: 24px;
        width: 100%;
        max-width: 500px;
        transform: translateY(20px);
        transition: transform 0.3s ease;
      }

      .modal.active .modal-content {
        transform: translateY(0);
      }
    </style>
  </head>

  <body class="min-h-screen">
    <!-- Header and Sidebar (optional for standalone) -->
    <header class="bg-white shadow-sm fixed top-0 left-0 right-0 z-30">
      <div class="flex items-center justify-between px-4 h-16">
        <div class="flex items-center">
          <button
            id="sidebar-toggle"
            class="w-10 h-10 flex items-center justify-center text-gray-500 hover:text-primary mr-2"
          >
            <i class="ri-menu-line ri-lg"></i>
          </button>
          <div class="font-['Pacifico'] text-xl text-primary">Sales-Spy</div>
          <span class="ml-4 text-lg font-medium hidden md:block"
            >Admin Dashboard</span
          >
        </div>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <div class="relative group" id="notification-dropdown-wrapper">
              <button
                id="notification-btn"
                class="w-10 h-10 flex items-center justify-center text-gray-500 hover:text-primary relative transition-colors duration-200"
              >
                <i class="ri-notification-3-line ri-lg"></i>
                <span
                  id="notification-count"
                  class="absolute top-1.5 right-1.5 min-w-[14px] h-4 px-0.5 bg-red-500 text-white text-[10px] font-semibold rounded-full flex items-center justify-center transition-all duration-200"
                  >0</span
                >
              </button>
              <!-- Dropdown -->
              <div
                id="notification-dropdown"
                class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-100 z-40 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto transition-all duration-200 translate-y-2 group-hover:translate-y-0"
              >
                <div
                  class="py-2 px-4 border-b border-gray-100 flex items-center justify-between"
                >
                  <span class="font-medium text-gray-800 text-base"
                    >Notifications</span
                  >
                  <button
                    id="mark-all-read"
                    class="text-xs text-primary hover:underline focus:outline-none transition-colors duration-150"
                  >
                    Mark all as read
                  </button>
                </div>
                <ul
                  id="notification-list"
                  class="max-h-72 overflow-y-auto divide-y divide-gray-100"
                >
                  <!-- Notifications will be rendered here -->
                </ul>
                <div class="py-2 px-4 text-center">
                  <a
                    href="AdminNotifications.html"
                    class="inline-block px-4 py-2 bg-primary text-white rounded-button text-sm font-medium hover:bg-blue-700 transition-colors duration-200"
                    >See more</a
                  >
                </div>
              </div>
            </div>
            <script>
              // Dynamic notifications array (simulate fetching from backend)
              let notifications = [];

              // Store timeouts for each notification
              let notificationTimeouts = {};

              // Simulate fetching notifications from backend (replace with real fetch in production)
              function fetchNotifications() {
                setTimeout(() => {
                  notifications = [
                    {
                      id: 1,
                      text: "New payment received from Emma Brown.",
                      time: "2 min ago",
                      read: false,
                    },
                    {
                      id: 2,
                      text: "Subscription for Robert Johnson is about to expire.",
                      time: "10 min ago",
                      read: false,
                    },
                    {
                      id: 3,
                      text: "David Miller upgraded to Pro plan.",
                      time: "30 min ago",
                      read: false,
                    },
                    {
                      id: 4,
                      text: "Jessica Thompson's payment failed.",
                      time: "1 hour ago",
                      read: false,
                    },
                    {
                      id: 5,
                      text: "Sarah Wilson added a new wallet.",
                      time: "2 hours ago",
                      read: false,
                    },
                    {
                      id: 6,
                      text: "Ava Lee requested support.",
                      time: "3 hours ago",
                      read: true,
                    },
                  ];
                  renderNotifications();
                }, 200);
              }

              function renderNotifications() {
                const list = document.getElementById("notification-list");
                const count = document.getElementById("notification-count");
                // Only show unread or recently marked-as-read notifications (pending removal)
                const visibleNotifications = notifications.filter(
                  (n) => !n.read
                );
                count.textContent = visibleNotifications.length;
                count.style.display =
                  visibleNotifications.length > 0 ? "flex" : "none";
                if (visibleNotifications.length === 0) {
                  list.innerHTML = `<li class="px-4 py-6 text-center text-gray-400 text-sm">All clear, nothing to see here</li>`;
                  return;
                }
                list.innerHTML = visibleNotifications
                  .slice(0, 5)
                  .map(
                    (n) => `
                  <li class="flex items-start gap-3 px-4 py-3 bg-white hover:bg-blue-50 transition-colors duration-150" data-id="${n.id}">
                  <div class="flex-1">
                  <p class="text-sm text-gray-800">${n.text}</p>
                  <span class="text-xs text-gray-400">${n.time}</span>
                  </div>
                  <div class="flex flex-col gap-1 ml-2">
                  <button class="mark-read-btn px-2 py-1 text-xs font-medium text-primary border border-primary rounded transition hover:bg-primary hover:text-white focus:outline-none" data-id="${n.id}">Mark as read</button>
                  </div>
                  </li>
                `
                  )
                  .join("");
              }

              // Dropdown hover for accessibility (also works on click for mobile)
              const dropdown = document.getElementById("notification-dropdown");
              const wrapper = document.getElementById(
                "notification-dropdown-wrapper"
              );
              let dropdownTimeout;
              wrapper.addEventListener("mouseenter", () => {
                clearTimeout(dropdownTimeout);
                dropdown.classList.add(
                  "opacity-100",
                  "pointer-events-auto",
                  "translate-y-0"
                );
                dropdown.classList.remove(
                  "opacity-0",
                  "pointer-events-none",
                  "translate-y-2"
                );
              });
              wrapper.addEventListener("mouseleave", () => {
                dropdownTimeout = setTimeout(() => {
                  dropdown.classList.remove(
                    "opacity-100",
                    "pointer-events-auto",
                    "translate-y-0"
                  );
                  dropdown.classList.add(
                    "opacity-0",
                    "pointer-events-none",
                    "translate-y-2"
                  );
                }, 120);
              });

              // Mark as read logic with delayed removal
              document.addEventListener("click", function (e) {
                if (e.target.classList.contains("mark-read-btn")) {
                  const id = +e.target.getAttribute("data-id");
                  const n = notifications.find((n) => n.id === id);
                  if (n && !n.read) {
                    n.read = true;
                    renderNotifications();
                    // Remove after 2 seconds
                    if (notificationTimeouts[id])
                      clearTimeout(notificationTimeouts[id]);
                    notificationTimeouts[id] = setTimeout(() => {
                      notifications = notifications.filter(
                        (notif) => notif.id !== id
                      );
                      delete notificationTimeouts[id];
                      renderNotifications();
                    }, 2000);
                  }
                }
                if (e.target.id === "mark-all-read") {
                  // Mark all as read and remove after 2 seconds
                  const idsToRemove = notifications
                    .filter((n) => !n.read)
                    .map((n) => n.id);
                  notifications.forEach((n) => {
                    n.read = true;
                  });
                  renderNotifications();
                  idsToRemove.forEach((id) => {
                    if (notificationTimeouts[id])
                      clearTimeout(notificationTimeouts[id]);
                    notificationTimeouts[id] = setTimeout(() => {
                      notifications = notifications.filter(
                        (notif) => notif.id !== id
                      );
                      delete notificationTimeouts[id];
                      renderNotifications();
                    }, 2000);
                  });
                }
              });

              // Initial fetch and render
              fetchNotifications();
            </script>
          </div>
          <div class="relative">
            <button id="user-menu-btn" class="flex items-center">
              <div
                class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center"
              >
                <span class="text-sm font-medium">JD</span>
              </div>
              <span class="ml-2 text-sm font-medium hidden md:block"
                >John Doe</span
              >
              <i class="ri-arrow-down-s-line ml-1 text-gray-500"></i>
            </button>
          </div>
        </div>
      </div>
      <!-- Sidebar toggle for mobile/tablet only -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const sidebarToggle = document.getElementById("sidebar-toggle");
          const sidebar = document.getElementById("sidebar");
          const main = document.querySelector("main");
          const menuIcon = sidebarToggle.querySelector("i");

          function setSidebar(open) {
            if (open) {
              sidebar.classList.remove("-translate-x-full");
              sidebar.classList.add("translate-x-0");
              menuIcon.classList.remove("ri-menu-line");
              menuIcon.classList.add("ri-close-line");
            } else {
              sidebar.classList.remove("translate-x-0");
              sidebar.classList.add("-translate-x-full");
              menuIcon.classList.remove("ri-close-line");
              menuIcon.classList.add("ri-menu-line");
            }
          }

          sidebarToggle.addEventListener("click", function () {
            const isClosed = sidebar.classList.contains("-translate-x-full");
            setSidebar(isClosed);
          });

          function handleResize() {
            if (window.innerWidth >= 768) {
              sidebar.classList.remove("-translate-x-full");
              sidebar.classList.add("translate-x-0");
              main.classList.add("md:pl-64");
              menuIcon.classList.remove("ri-close-line");
              menuIcon.classList.add("ri-menu-line");
            } else {
              sidebar.classList.remove("translate-x-0");
              sidebar.classList.add("-translate-x-full");
              main.classList.remove("md:pl-64");
              menuIcon.classList.remove("ri-close-line");
              menuIcon.classList.add("ri-menu-line");
            }
          }

          window.addEventListener("resize", handleResize);
          handleResize();
        });
      </script>
    </header>
    <!-- Sidebar -->
    <aside
      id="sidebar"
      class="fixed top-16 left-0 bottom-0 w-64 bg-white shadow-sm z-20 sidebar-transition transform md:translate-x-0 -translate-x-full"
    >
      <div class="h-full flex flex-col">
        <div class="p-4 border-b">
          <div class="flex items-center">
            <div
              class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center"
            >
              <span class="text-sm font-medium">JD</span>
            </div>
            <div class="ml-3">
              <p class="text-sm font-medium">John Doe</p>
              <p class="text-xs text-gray-500">Super Admin</p>
            </div>
          </div>
        </div>
        <nav class="flex-1 p-4 overflow-y-auto">
          <ul class="space-y-1">
            <li>
              <a
                href="AdminUsers.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-primary bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-user-line"></i>
                </div>
                <span>Users</span>
              </a>
            </li>
            <li>
              <a
                href="AdminSubscriptions.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-vip-crown-line"></i>
                </div>
                <span>Subscriptions</span>
              </a>
            </li>
            <li>
              <a
                href="AdminWallets.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-wallet-3-line"></i>
                </div>
                <span>Wallets</span>
              </a>
            </li>
            <li>
              <a
                href="AdminPlans.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-list-settings-line"></i>
                </div>
                <span>Plans</span>
              </a>
            </li>
            <li>
              <a
                href="AdminPayments.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-exchange-dollar-line"></i>
                </div>
                <span>Payments</span>
              </a>
            </li>
            <li>
              <a
                href="AdminPending.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-time-line"></i>
                </div>
                <span>Pending Payments</span>
              </a>
            </li>
            <li>
              <a
                href="AdminNotifications.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-notification-3-line"></i>
                </div>
                <span>Notifications</span>
              </a>
            </li>
            <li>
              <a
                href="Admins.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-shield-user-line"></i>
                </div>
                <span>Admins</span>
              </a>
            </li>
            <li>
              <a
                href="AdminHistory.html"
                class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-history-line"></i>
                </div>
                <span>Admin History</span>
              </a>
            </li>
            <li>
              <a
                href="AdminSettings.html"
                 class="nav-link w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-primary hover:bg-blue-50"
              >
                <div class="w-5 h-5 flex items-center justify-center mr-3">
                  <i class="ri-settings-3-line"></i>
                </div>
                <span>Settings</span>
              </a>
            </li>
          </ul>
        </nav>
        <div class="p-4 border-t">
          <button
            id="logout-btn"
            class="w-full flex items-center px-3 py-2 text-sm font-medium rounded-md text-red-600 hover:bg-red-50"
          >
            <div class="w-5 h-5 flex items-center justify-center mr-3">
              <i class="ri-logout-box-line"></i>
            </div>
            <span>Logout</span>
          </button>
        </div>
        <!-- Logout Confirmation Modal -->
        <div id="logout-modal" class="modal">
          <div class="modal-content max-w-sm">
            <div class="flex items-center mb-4">
              <div
                class="w-12 h-12 rounded-full bg-red-100 text-red-600 flex items-center justify-center mr-4"
              >
                <i class="ri-logout-box-line ri-lg"></i>
              </div>
              <h3 class="text-lg font-medium text-gray-800">
                Are you sure you want to logout?
              </h3>
            </div>
            <div class="flex items-center justify-end space-x-3">
              <button
                id="cancel-logout"
                class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50"
              >
                Cancel
              </button>
              <button
                id="confirm-logout"
                class="px-4 py-2 bg-red-600 text-white rounded-button whitespace-nowrap hover:bg-red-700"
              >
                Logout
              </button>
            </div>
          </div>
        </div>
      </div>
    </aside>
    <main class="pt-16 md:pl-64 transition-all duration-300">
      <!-- Users Tab -->
      <div id="users-tab" class="tab-content p-4 md:p-6">
        <div class="mb-6">
          <h1 class="text-2xl font-semibold text-gray-800">Users Management</h1>
          <p class="text-sm text-gray-500 mt-1">
            Manage all registered users and their accounts
          </p>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
          <div
            class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"
          >
            <div class="relative flex-1">
              <div
                class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"
              >
                <i class="ri-search-line text-gray-400"></i>
              </div>
              <input
                type="text"
                id="user-search"
                class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
                placeholder="Search users by name or email..."
              />
            </div>
            <div class="flex flex-wrap items-center gap-3">
              <div class="custom-select" id="plan-filter">
                <div class="custom-select-trigger">
                  <span>All Plans</span>
                  <i class="ri-arrow-down-s-line ml-2"></i>
                </div>
                <div class="custom-select-options">
                  <div class="custom-select-option" data-value="all">
                    All Plans
                  </div>
                  <div class="custom-select-option" data-value="basic">
                    Basic
                  </div>
                  <div class="custom-select-option" data-value="pro">Pro</div>
                  <div class="custom-select-option" data-value="enterprise">
                    Enterprise
                  </div>
                </div>
              </div>
              <div class="custom-select" id="status-filter">
                <div class="custom-select-trigger">
                  <span>All Status</span>
                  <i class="ri-arrow-down-s-line ml-2"></i>
                </div>
                <div class="custom-select-options">
                  <div class="custom-select-option" data-value="all">
                    All Status
                  </div>
                  <div class="custom-select-option" data-value="active">
                    Active
                  </div>
                  <div class="custom-select-option" data-value="suspended">
                    Suspended
                  </div>
                </div>
              </div>
              <button
                class="px-4 py-2 bg-primary text-white rounded-button whitespace-nowrap flex items-center"
                id="export-users-btn"
              >
                <i class="ri-download-2-line mr-2"></i>
                Export
              </button>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
          <div class="overflow-x-auto">
            <table class="w-full" id="users-table">
              <thead>
                <tr class="bg-gray-50">
                  <th class="px-4 py-3 text-left">
                    <label class="custom-checkbox">
                      <input type="checkbox" id="select-all-users" />
                      <span class="checkbox-mark"></span>
                    </label>
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    User
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Email
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Plan
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Wallet
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Joined
                  </th>
                  <th
                    class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Status
                  </th>
                  <th
                    class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-200" id="users-table-body">
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>
          <div class="px-4 py-3 flex items-center justify-between border-t">
            <div
              class="flex items-center text-sm text-gray-500"
              id="users-pagination-info"
            >
              <span>Showing</span>
              <div class="custom-select mx-2" id="page-size-select">
                <div class="custom-select-trigger">
                  <span>10</span>
                  <i class="ri-arrow-down-s-line ml-1"></i>
                </div>
                <div class="custom-select-options">
                  <div class="custom-select-option" data-value="10">10</div>
                  <div class="custom-select-option" data-value="20">20</div>
                  <div class="custom-select-option" data-value="50">50</div>
                </div>
              </div>
              <span id="users-total-count">of 50 users</span>
            </div>
            <div class="flex items-center space-x-1" id="users-pagination">
              <button
                class="pagination-item text-gray-500 hover:bg-gray-100"
                id="users-prev-page"
              >
                <i class="ri-arrow-left-s-line"></i>
              </button>
              <!-- Page numbers will be injected here -->
              <button
                class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                data-page="1"
              >
                1
              </button>
              <button
                class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                data-page="2"
              >
                2
              </button>
              <button
                class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                data-page="3"
              >
                3
              </button>
              <button
                class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                data-page="4"
              >
                4
              </button>
              <button
                class="pagination-item text-gray-600 hover:bg-gray-100 users-page-btn"
                data-page="5"
              >
                5
              </button>
              <button
                class="pagination-item text-gray-500 hover:bg-gray-100"
                id="users-next-page"
              >
                <i class="ri-arrow-right-s-line"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Modals -->
    <!-- Unsuspend User Modal -->
    <div id="unsuspend-user-modal" class="modal">
      <div class="modal-content">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-800">Unsuspend User</h3>
          <button class="modal-close text-gray-400 hover:text-gray-500">
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <div class="space-y-4">
          <div class="flex items-center">
            <div
              class="w-12 h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center"
            >
              <i class="ri-play-circle-line ri-lg"></i>
            </div>
            <div class="ml-4">
              <h4 class="text-lg font-medium text-gray-800">
                Are you sure you want to unsuspend this user?
              </h4>
              <p class="text-sm text-gray-500">
                The user will regain access to their account immediately.
              </p>
            </div>
          </div>
          <div>
            <label
              for="unsuspend-reason"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Reason for unsuspension (optional)</label
            >
            <textarea
              id="unsuspend-reason"
              rows="3"
              class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
              placeholder="Enter reason for unsuspension..."
            ></textarea>
          </div>
          <div class="flex items-center">
            <label class="custom-checkbox">
              <input type="checkbox" checked />
              <span class="checkbox-mark"></span>
            </label>
            <span class="ml-2 text-sm text-gray-600"
              >Send email notification to user</span
            >
          </div>
          <div class="flex items-center justify-end space-x-3 pt-4 border-t">
            <button
              class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50 modal-close"
            >
              Cancel
            </button>
            <button
              class="px-4 py-2 bg-green-600 text-white rounded-button whitespace-nowrap"
              id="confirm-unsuspend-user"
            >
              Unsuspend User
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="view-user-modal" class="modal">
      <div class="modal-content">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-800">User Details</h3>
          <button class="modal-close text-gray-400 hover:text-gray-500">
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <div class="space-y-4">
          <div class="flex items-center">
            <div
              class="w-16 h-16 rounded-full bg-blue-100 text-primary flex items-center justify-center"
            >
              <span class="text-xl font-medium">EB</span>
            </div>
            <div class="ml-4">
              <h4 class="text-xl font-medium text-gray-800">Emma Brown</h4>
              <p class="text-sm text-gray-500">emma.brown@example.com</p>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <p class="text-sm text-gray-500">Subscription</p>
              <p class="text-sm font-medium text-gray-800">Pro Plan</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Status</p>
              <p class="text-sm font-medium text-green-600">Active</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Joined</p>
              <p class="text-sm font-medium text-gray-800">Jun 12, 2025</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Wallet</p>
              <p class="text-sm font-medium text-green-600">Connected</p>
            </div>
          </div>
          <div>
            <p class="text-sm text-gray-500">Wallet Address</p>
            <div class="flex items-center mt-1">
              <p class="text-sm font-medium text-gray-800 truncate">
                0x71C7656EC7ab88b098defB751B7401B5f6d8976F
              </p>
              <button class="ml-2 text-gray-400 hover:text-primary">
                <i class="ri-file-copy-line"></i>
              </button>
            </div>
          </div>
          <div>
            <p class="text-sm text-gray-500">Recent Transactions</p>
            <div class="mt-2 space-y-2">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <div
                    class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center"
                  >
                    <i class="ri-arrow-down-line"></i>
                  </div>
                  <div class="ml-3">
                    <p class="text-sm font-medium text-gray-800">
                      Pro Plan Subscription
                    </p>
                    <p class="text-xs text-gray-500">Jun 25, 2025</p>
                  </div>
                </div>
                <p class="text-sm font-medium text-gray-800">0.05 ETH</p>
              </div>
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <div
                    class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center"
                  >
                    <i class="ri-arrow-down-line"></i>
                  </div>
                  <div class="ml-3">
                    <p class="text-sm font-medium text-gray-800">
                      Pro Plan Subscription
                    </p>
                    <p class="text-xs text-gray-500">May 25, 2025</p>
                  </div>
                </div>
                <p class="text-sm font-medium text-gray-800">0.05 ETH</p>
              </div>
            </div>
          </div>
          <div class="flex items-center justify-end space-x-3 pt-4 border-t">
            <button
              class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50 modal-close"
            >
              Close
            </button>
            <button
              class="px-4 py-2 border border-yellow-200 text-yellow-600 rounded-button whitespace-nowrap hover:bg-yellow-50"
            >
              Suspend User
            </button>
            <button
              class="px-4 py-2 border border-red-200 text-red-600 rounded-button whitespace-nowrap hover:bg-red-50"
            >
              Delete User
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="delete-user-modal" class="modal">
      <div class="modal-content">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-800">Delete User</h3>
          <button class="modal-close text-gray-400 hover:text-gray-500">
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <div class="space-y-4">
          <div class="flex items-center">
            <div
              class="w-12 h-12 rounded-full bg-red-100 text-red-600 flex items-center justify-center"
            >
              <i class="ri-delete-bin-line ri-lg"></i>
            </div>
            <div class="ml-4">
              <h4 class="text-lg font-medium text-gray-800">
                Are you sure you want to delete this user?
              </h4>
              <p class="text-sm text-gray-500">
                This action cannot be undone. All user data, subscriptions, and
                wallet information will be permanently removed.
              </p>
            </div>
          </div>
          <div class="bg-yellow-50 p-4 rounded-lg">
            <div class="flex">
              <div class="flex-shrink-0">
                <i class="ri-error-warning-line text-yellow-600"></i>
              </div>
              <div class="ml-3">
                <h3 class="text-sm font-medium text-yellow-800">Warning</h3>
                <div class="mt-2 text-sm text-yellow-700">
                  <p>
                    Deleting a user with active subscriptions may result in
                    payment issues. Consider suspending the user instead.
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div>
            <label
              for="delete-confirmation"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Type "DELETE" to confirm</label
            >
            <input
              type="text"
              id="delete-confirmation"
              class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
              placeholder="DELETE"
            />
          </div>
          <div class="flex items-center justify-end space-x-3 pt-4 border-t">
            <button
              class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50 modal-close"
            >
              Cancel
            </button>
            <button
              class="px-4 py-2 bg-red-600 text-white rounded-button whitespace-nowrap"
            >
              Delete User
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="suspend-user-modal" class="modal">
      <div class="modal-content">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-medium text-gray-800">Suspend User</h3>
          <button class="modal-close text-gray-400 hover:text-gray-500">
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <div class="space-y-4">
          <div class="flex items-center">
            <div
              class="w-12 h-12 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center"
            >
              <i class="ri-pause-circle-line ri-lg"></i>
            </div>
            <div class="ml-4">
              <h4 class="text-lg font-medium text-gray-800">
                Are you sure you want to suspend this user?
              </h4>
              <p class="text-sm text-gray-500">
                The user will not be able to access their account until you
                reactivate it.
              </p>
            </div>
          </div>
          <div>
            <label
              for="suspension-reason"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Reason for suspension (optional)</label
            >
            <textarea
              id="suspension-reason"
              rows="3"
              class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
              placeholder="Enter reason for suspension..."
            ></textarea>
          </div>
          <div>
            <label
              for="suspension-duration"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Suspension Duration</label
            >
            <div class="custom-select" id="suspension-duration-select">
              <div class="custom-select-trigger">
                <span>1 week</span>
                <i class="ri-arrow-down-s-line ml-2"></i>
              </div>
              <div class="custom-select-options">
                <div class="custom-select-option" data-value="1day">1 day</div>
                <div class="custom-select-option" data-value="1week">
                  1 week
                </div>
                <div class="custom-select-option" data-value="1month">
                  1 month
                </div>
                <div class="custom-select-option" data-value="indefinite">
                  Indefinite
                </div>
              </div>
            </div>
          </div>
          <div class="flex items-center">
            <label class="custom-checkbox">
              <input type="checkbox" />
              <span class="checkbox-mark"></span>
            </label>
            <span class="ml-2 text-sm text-gray-600"
              >Send email notification to user</span
            >
          </div>
          <div class="flex items-center justify-end space-x-3 pt-4 border-t">
            <button
              class="px-4 py-2 border border-gray-200 text-gray-600 rounded-button whitespace-nowrap hover:bg-gray-50 modal-close"
            >
              Cancel
            </button>
            <button
              class="px-4 py-2 bg-yellow-600 text-white rounded-button whitespace-nowrap"
            >
              Suspend User
            </button>
          </div>
        </div>
      </div>
    </div>
    <script>
      (function () {
        // Mock user data
        const mockUsers = [];
        const plans = [
          { name: "Basic", color: "bg-gray-100 text-gray-600" },
          { name: "Pro", color: "bg-blue-50 text-primary" },
          { name: "Enterprise", color: "bg-purple-50 text-purple-600" },
        ];
        const statuses = [
          { name: "Active", color: "bg-green-50 text-green-600" },
          { name: "Suspended", color: "bg-yellow-50 text-yellow-600" },
        ];
        const walletStates = [
          { name: "Connected", color: "text-green-600 bg-green-50" },
          { name: "Not Connected", color: "text-gray-600 bg-gray-100" },
        ];
        const names = [
          "Emma Brown",
          "Robert Johnson",
          "Sarah Wilson",
          "David Miller",
          "Jessica Thompson",
          "Michael Lee",
          "Sophia Davis",
          "James Smith",
          "Olivia Garcia",
          "William Martinez",
          "Ava Rodriguez",
          "Benjamin Anderson",
          "Mia Hernandez",
          "Lucas Clark",
          "Charlotte Lewis",
          "Henry Walker",
          "Amelia Hall",
          "Jack Allen",
          "Emily Young",
          "Alexander King",
          "Ella Wright",
          "Daniel Scott",
          "Grace Green",
          "Matthew Adams",
          "Chloe Baker",
          "Sebastian Nelson",
          "Harper Carter",
          "Jackson Mitchell",
          "Lily Perez",
          "Logan Roberts",
          "Zoe Turner",
          "Mason Phillips",
          "Layla Campbell",
          "Elijah Parker",
          "Scarlett Evans",
          "Aiden Edwards",
          "Penelope Collins",
          "Carter Stewart",
          "Riley Sanchez",
          "Wyatt Morris",
          "Victoria Rogers",
          "Julian Reed",
          "Hannah Cook",
          "Levi Morgan",
          "Aria Bell",
          "Gabriel Murphy",
          "Nora Bailey",
          "Lincoln Rivera",
          "Sofia Cooper",
          "Samuel Richardson",
        ];
        for (let i = 0; i < 50; i++) {
          const planIdx = Math.floor(Math.random() * plans.length);
          const statusIdx = Math.random() < 0.8 ? 0 : 1; // 80% active, 20% suspended
          const walletIdx = Math.random() < 0.8 ? 0 : 1; // 80% connected
          const joined = new Date(
            2025,
            Math.floor(Math.random() * 6),
            1 + Math.floor(Math.random() * 28)
          );
          const initials = names[i]
            .split(" ")
            .map((n) => n[0])
            .join("");
          mockUsers.push({
            id: i + 1,
            name: names[i],
            email: names[i].toLowerCase().replace(/ /g, ".") + "@example.com",
            plan: plans[planIdx].name,
            planColor: plans[planIdx].color,
            wallet: walletStates[walletIdx].name,
            walletColor: walletStates[walletIdx].color,
            joined: joined.toLocaleDateString("en-US", {
              month: "short",
              day: "2-digit",
              year: "numeric",
            }),
            status: statuses[statusIdx].name,
            statusColor: statuses[statusIdx].color,
            initials: initials,
          });
        }

        // State
        let filteredUsers = [...mockUsers];
        let currentPage = 1;
        let pageSize = 10;
        let planFilter = "all";
        let statusFilter = "all";
        let searchQuery = "";

        // DOM
        const tbody = document.getElementById("users-table-body");
        const pageSizeSelect = document.getElementById("page-size-select");
        const planFilterSelect = document.getElementById("plan-filter");
        const statusFilterSelect = document.getElementById("status-filter");
        const searchInput = document.getElementById("user-search");
        const pagination = document.getElementById("users-pagination");
        const prevBtn = document.getElementById("users-prev-page");
        const nextBtn = document.getElementById("users-next-page");
        const pageInfo = document.getElementById("users-pagination-info");
        const totalCount = document.getElementById("users-total-count");

        // For unsuspend modal
        let unsuspendUserId = null;

        // Render
        function renderTable() {
          // Filter
          filteredUsers = mockUsers.filter((u) => {
            let matchesPlan =
              planFilter === "all" || u.plan.toLowerCase() === planFilter;
            let matchesStatus =
              statusFilter === "all" || u.status.toLowerCase() === statusFilter;
            let matchesSearch =
              !searchQuery ||
              u.name.toLowerCase().includes(searchQuery) ||
              u.email.toLowerCase().includes(searchQuery);
            return matchesPlan && matchesStatus && matchesSearch;
          });
          // Pagination
          const total = filteredUsers.length;
          const totalPages = Math.max(1, Math.ceil(total / pageSize));
          if (currentPage > totalPages) currentPage = totalPages;
          const start = (currentPage - 1) * pageSize;
          const end = Math.min(start + pageSize, total);
          const usersToShow = filteredUsers.slice(start, end);

          // Table rows
          tbody.innerHTML = usersToShow
            .map(
              (user) => `
            <tr>
                <td class="px-4 py-3 whitespace-nowrap">
                    <label class="custom-checkbox">
                        <input type="checkbox" class="user-checkbox">
                        <span class="checkbox-mark"></span>
                    </label>
                </td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full ${
                          user.plan === "Pro"
                            ? "bg-blue-100 text-primary"
                            : user.plan === "Enterprise"
                            ? "bg-purple-100 text-purple-600"
                            : user.plan === "Basic"
                            ? "bg-orange-100 text-orange-600"
                            : "bg-gray-100 text-gray-600"
                        } flex items-center justify-center">
                            <span class="text-sm font-medium">${
                              user.initials
                            }</span>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm font-medium text-gray-800">${
                              user.name
                            }</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-600">${
                  user.email
                }</td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium ${
                      user.planColor
                    } rounded-full">${user.plan}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="text-xs font-medium ${
                      user.walletColor
                    } px-2 py-1 rounded-full">${user.wallet}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-600">${
                  user.joined
                }</td>
                <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium ${
                      user.statusColor
                    } rounded-full">${user.status}</span>
                </td>
                <td class="px-4 py-3 whitespace-nowrap text-right text-sm font-medium">
                    <div class="flex items-center justify-end space-x-2">
                        <button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-primary rounded-full hover:bg-blue-50" data-action="view" data-user-id="${
                          user.id
                        }">
                            <i class="ri-eye-line"></i>
                        </button>
                        ${
                          user.status === "Suspended"
                            ? `<button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-green-500 rounded-full hover:bg-green-50" data-action="activate" data-user-id="${user.id}">
                                        <i class="ri-play-circle-line"></i>
                                    </button>`
                            : `<button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-yellow-500 rounded-full hover:bg-yellow-50" data-action="suspend" data-user-id="${user.id}">
                                        <i class="ri-pause-circle-line"></i>
                                    </button>`
                        }
                        <button class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-red-500 rounded-full hover:bg-red-50" data-action="delete" data-user-id="${
                          user.id
                        }">
                            <i class="ri-delete-bin-line"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `
            )
            .join("");

          // Pagination info
          pageInfo.querySelector(
            "span"
          ).nextElementSibling.nextElementSibling.textContent = `of ${total} users`;
          pageInfo.querySelector(
            "span"
          ).nextElementSibling.textContent = `${pageSize}`;

          // Pagination buttons
          renderPagination(totalPages);

          // Select all checkbox
          const selectAll = document.getElementById("select-all-users");
          const checkboxes = tbody.querySelectorAll(".user-checkbox");
          if (selectAll) {
            selectAll.checked = false;
            selectAll.onchange = function () {
              checkboxes.forEach((cb) => (cb.checked = selectAll.checked));
            };
          }

          // Re-attach modal event listeners for user action buttons
          setTimeout(() => {
            const viewUserButtons = tbody.querySelectorAll(
              '[data-action="view"]'
            );
            const deleteUserButtons = tbody.querySelectorAll(
              '[data-action="delete"]'
            );
            const suspendUserButtons = tbody.querySelectorAll(
              '[data-action="suspend"]'
            );
            const activateUserButtons = tbody.querySelectorAll(
              '[data-action="activate"]'
            );
            viewUserButtons.forEach((button) => {
              button.onclick = function () {
                const userId = this.getAttribute("data-user-id");
                const modal = document.getElementById("view-user-modal");
                if (modal) {
                  modal.classList.add("active");
                  document.body.style.overflow = "hidden";
                }
              };
            });
            deleteUserButtons.forEach((button) => {
              button.onclick = function () {
                const userId = this.getAttribute("data-user-id");
                const modal = document.getElementById("delete-user-modal");
                if (modal) {
                  modal.classList.add("active");
                  document.body.style.overflow = "hidden";
                }
              };
            });
            suspendUserButtons.forEach((button) => {
              button.onclick = function () {
                const userId = this.getAttribute("data-user-id");
                const modal = document.getElementById("suspend-user-modal");
                if (modal) {
                  modal.classList.add("active");
                  document.body.style.overflow = "hidden";
                }
              };
            });
            // Unsuspend (activate) user modal
            activateUserButtons.forEach((button) => {
              button.onclick = function () {
                unsuspendUserId = this.getAttribute("data-user-id");
                const modal = document.getElementById("unsuspend-user-modal");
                if (modal) {
                  modal.classList.add("active");
                  document.body.style.overflow = "hidden";
                }
              };
            });
          }, 0);
        }

        function renderPagination(totalPages) {
          // Remove old page buttons
          pagination
            .querySelectorAll(".users-page-btn")
            .forEach((btn) => btn.remove());
          // Insert new page buttons
          for (let i = 1; i <= totalPages; i++) {
            const btn = document.createElement("button");
            btn.className =
              "pagination-item text-gray-600 hover:bg-gray-100 users-page-btn";
            btn.textContent = i;
            btn.setAttribute("data-page", i);
            if (i === currentPage)
              btn.classList.add("active", "bg-blue-50", "text-primary");
            btn.onclick = function () {
              currentPage = i;
              renderTable();
            };
            pagination.insertBefore(btn, nextBtn);
          }
          // Prev/next
          prevBtn.disabled = currentPage === 1;
          nextBtn.disabled = currentPage === totalPages;
          prevBtn.classList.toggle("opacity-50", prevBtn.disabled);
          prevBtn.classList.toggle("cursor-not-allowed", prevBtn.disabled);
          nextBtn.classList.toggle("opacity-50", nextBtn.disabled);
          nextBtn.classList.toggle("cursor-not-allowed", nextBtn.disabled);
        }

        // Event listeners
        prevBtn.onclick = function () {
          if (currentPage > 1) {
            currentPage--;
            renderTable();
          }
        };
        nextBtn.onclick = function () {
          const total = filteredUsers.length;
          const totalPages = Math.max(1, Math.ceil(total / pageSize));
          if (currentPage < totalPages) {
            currentPage++;
            renderTable();
          }
        };

        // Page size select
        pageSizeSelect.addEventListener("change", function (e) {
          const value = pageSizeSelect.getAttribute("data-value");
          if (value) {
            pageSize = parseInt(value, 10);
            currentPage = 1;
            renderTable();
          }
        });
        // Plan filter
        planFilterSelect.addEventListener("change", function (e) {
          planFilter = planFilterSelect.getAttribute("data-value") || "all";
          currentPage = 1;
          renderTable();
        });
        // Status filter
        statusFilterSelect.addEventListener("change", function (e) {
          statusFilter = statusFilterSelect.getAttribute("data-value") || "all";
          currentPage = 1;
          renderTable();
        });
        // Search
        searchInput.addEventListener("input", function () {
          searchQuery = searchInput.value.trim().toLowerCase();
          currentPage = 1;
          renderTable();
        });

        // Export (CSV)
        document.getElementById("export-users-btn").onclick = function () {
          let csv = "Name,Email,Plan,Wallet,Joined,Status\n";
          filteredUsers.forEach((u) => {
            csv += `"${u.name}","${u.email}","${u.plan}","${u.wallet}","${u.joined}","${u.status}"\n`;
          });
          const blob = new Blob([csv], { type: "text/csv" });
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "users.csv";
          a.click();
        };

        // Unsuspend user modal logic
        document.addEventListener("DOMContentLoaded", function () {
          const unsuspendModal = document.getElementById(
            "unsuspend-user-modal"
          );
          const confirmBtn = document.getElementById("confirm-unsuspend-user");
          if (confirmBtn) {
            confirmBtn.onclick = function () {
              if (unsuspendUserId) {
                // Find user and set status to Active
                const user = mockUsers.find((u) => u.id == unsuspendUserId);
                if (user) {
                  user.status = "Active";
                  user.statusColor = "bg-green-50 text-green-600";
                }
                unsuspendUserId = null;
                renderTable();
              }
              if (unsuspendModal) {
                unsuspendModal.classList.remove("active");
                document.body.style.overflow = "";
              }
            };
          }
        });

        // Initial render
        renderTable();

        // Custom select event patch for vanilla selects
        // (so the above .addEventListener("change") works)
        document.querySelectorAll(".custom-select").forEach((select) => {
          select.addEventListener("change", function (e) {
            // Already handled above
          });
        });
      })();
    </script>

    <script id="modal-script">
      document.addEventListener("DOMContentLoaded", function () {
        const modals = document.querySelectorAll(".modal");
        const modalCloseButtons = document.querySelectorAll(".modal-close");
        const toast = document.getElementById("toast-success");

        function showToast() {
          toast.classList.remove("translate-x-full");
          setTimeout(() => {
            toast.classList.add("translate-x-full");
          }, 3000);
        }

        // Handle wallet verification
        const verifyWalletButtons = document.querySelectorAll(
          '[data-action="verify"]'
        );
        const verifyWalletModal = document.getElementById(
          "verify-wallet-modal"
        );
        const confirmVerifyWalletBtn = document.getElementById(
          "confirm-verify-wallet"
        );

        verifyWalletButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const row = this.closest("tr");
            const userName = row.querySelector(
              ".text-sm.font-medium.text-gray-800"
            ).textContent;
            const blockchain = row.querySelector(
              ".text-sm.text-gray-600"
            ).textContent;
            const walletAddress = row.querySelector(
              ".text-sm.text-gray-600:nth-child(2)"
            ).textContent;

            document.getElementById("verify-wallet-user").textContent =
              userName;
            document.getElementById("verify-wallet-blockchain").textContent =
              blockchain;
            document.getElementById("verify-wallet-address").textContent =
              walletAddress;

            openModal("verify-wallet-modal");
          });
        });

        if (confirmVerifyWalletBtn) {
          confirmVerifyWalletBtn.addEventListener("click", function () {
            const walletAddress = document.getElementById(
              "verify-wallet-address"
            ).textContent;
            const statusElements = document.querySelectorAll(
              "td:nth-child(6) span"
            );

            statusElements.forEach((element) => {
              if (
                element
                  .closest("tr")
                  .querySelector(".text-sm.text-gray-600:nth-child(2)")
                  .textContent === walletAddress
              ) {
                element.className =
                  "px-2 py-1 text-xs font-medium bg-green-50 text-green-600 rounded-full";
                element.textContent = "Valid";
              }
            });

            closeModal(verifyWalletModal);
            showToast();
          });
        }
        // Add tooltip container to body
        const tooltip = document.createElement("div");
        tooltip.className =
          "fixed px-2 py-1 text-xs text-white bg-gray-900 rounded pointer-events-none opacity-0 transition-opacity duration-200 z-50";
        document.body.appendChild(tooltip);
        const logoutBtn = document.getElementById("logout-btn");
        const logoutModal = document.getElementById("logout-modal");
        const cancelLogoutBtn = document.getElementById("cancel-logout");
        const confirmLogoutBtn = document.getElementById("confirm-logout");
        // Handle logout flow
        if (logoutBtn) {
          logoutBtn.addEventListener("click", function () {
            openModal("logout-modal");
          });
        }
        if (cancelLogoutBtn) {
          cancelLogoutBtn.addEventListener("click", function () {
            closeModal(logoutModal);
          });
        }
        if (confirmLogoutBtn) {
          confirmLogoutBtn.addEventListener("click", function () {
            // Clear any session data here
            window.location.href = "/login"; // Redirect to login page
          });
        }
        // Action buttons for user actions
        const viewUserButtons = document.querySelectorAll(
          '[data-action="view"]'
        );
        const deleteUserButtons = document.querySelectorAll(
          '[data-action="delete"]'
        );
        const suspendUserButtons = document.querySelectorAll(
          '[data-action="suspend"]'
        );
        function openModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal) {
            modal.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        }
        function closeModal(modal) {
          modal.classList.remove("active");
          document.body.style.overflow = "";
        }
        // Close modal when clicking close button
        modalCloseButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const modal = this.closest(".modal");
            closeModal(modal);
          });
        });
        // Close modal when clicking outside the modal content
        modals.forEach((modal) => {
          modal.addEventListener("click", function (e) {
            if (e.target === this) {
              closeModal(this);
            }
          });
        });
        // Open user action modals
        viewUserButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const userId = this.getAttribute("data-user-id");
            openModal("view-user-modal");
          });
        });
        // Handle subscription action buttons
        const subscriptionButtons = document.querySelectorAll(
          ".subscription-action"
        );
        subscriptionButtons.forEach((button) => {
          // Tooltip handling
          button.addEventListener("mouseenter", function (e) {
            const tooltipText = this.getAttribute("data-tooltip");
            tooltip.textContent = tooltipText;
            tooltip.style.opacity = "1";
            // Position tooltip above the button
            const rect = this.getBoundingClientRect();
            tooltip.style.top = rect.top - 30 + "px";
            tooltip.style.left =
              rect.left + rect.width / 2 - tooltip.offsetWidth / 2 + "px";
          });
          button.addEventListener("mouseleave", function () {
            tooltip.style.opacity = "0";
          });
          // Modal handling
          button.addEventListener("click", function () {
            const action = this.getAttribute("data-action");
            switch (action) {
              case "history":
                openModal("subscription-history-modal");
                break;
              case "pause":
                openModal("pause-subscription-modal");
                break;
              case "cancel":
                openModal("cancel-subscription-modal");
                break;
            }
          });
        });
        deleteUserButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const userId = this.getAttribute("data-user-id");
            openModal("delete-user-modal");
          });
        });
        suspendUserButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const userId = this.getAttribute("data-user-id");
            openModal("suspend-user-modal");
          });
        });
      });
    </script>

    <script id="checkbox-script">
      document.addEventListener("DOMContentLoaded", function () {
        // Select all checkboxes
        const selectAllUsers = document.getElementById("select-all-users");
        const userCheckboxes = document.querySelectorAll(".user-checkbox");
        const selectAllWallets = document.getElementById("select-all-wallets");
        const walletCheckboxes = document.querySelectorAll(".wallet-checkbox");
        const selectAllTransactions = document.getElementById(
          "select-all-transactions"
        );
        const transactionCheckboxes = document.querySelectorAll(
          ".transaction-checkbox"
        );
        // Handle select all users
        if (selectAllUsers) {
          selectAllUsers.addEventListener("change", function () {
            userCheckboxes.forEach((checkbox) => {
              checkbox.checked = this.checked;
            });
          });
        }
        // Handle select all wallets
        if (selectAllWallets) {
          selectAllWallets.addEventListener("change", function () {
            walletCheckboxes.forEach((checkbox) => {
              checkbox.checked = this.checked;
            });
          });
        }
        // Handle select all transactions
        if (selectAllTransactions) {
          selectAllTransactions.addEventListener("change", function () {
            transactionCheckboxes.forEach((checkbox) => {
              checkbox.checked = this.checked;
            });
          });
        }
      });
    </script>
  </body>
</html>
